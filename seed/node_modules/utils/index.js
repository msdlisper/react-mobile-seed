const colors = require('colors');
const path = require('path');
const fs = require('fs');

const utils = {
    logs(param) {
        if (typeof param === 'string') {
            console.log(param);
        }
        else {
            const typeMsg = param.shift();
            const arr = typeMsg.split(':');
            const type = arr.shift();
            const msg = arr.join(':');
            switch (type) {
                case 'error':
                    console.error('[ ERROR ] '.red, msg);
                    break;
                case 'info':
                    console.error('[ INFO ] '.green, msg);
                    break;
                case 'warn':
                    console.error('[ WARNING ] '.yellow, msg);
                    break;
                case 'debug':
                    console.error('[ DEBUG ] '.cyan, msg);
                    break;
            }
        }
    },
    ensurePath(p) {
        if (!fs.existsSync(p)) {
            utils.ensurePath(path.dirname(p));
            fs.mkdirSync(p);
        }
    },
    isExist(p) {
        return !!fs.existsSync(p);
    },
    replaceTemplate(content = '', options = {}) {
        const keyReg = /@\{(\w+)\}@/g;
        let resultContent = content.replace(keyReg, function(match, key) {
            if (key in options) {
                return options[key];
            }
        })
        return resultContent;
    },
    getBuildTime: function () {
        let now = new Date();
        return '' + now.getFullYear() + (now.getMonth() + 1) + now.getDate() + now.getHours() + now.getMinutes();
    }
};

module.exports = utils;
